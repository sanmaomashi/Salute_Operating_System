# 远程操作

## 一、网卡 和 IP 地址

网卡（Network Interface Card，NIC）是计算机用于与网络通信的硬件设备，也被称为网络适配器或网络接口。它允许计算机与网络进行数据交换。

每个网卡都有一个唯一的硬件地址，称为 MAC 地址（Media Access Control address），用于在局域网中唯一标识网卡。

IP 地址（Internet Protocol address）是网络中用于标识和定位设备的逻辑地址。IP 地址由一系列数字组成，分为四个部分，每个部分的取值范围为 0 到 255。IP 地址用于在互联网中路由和传递数据。

一个计算机可以有一个或多个网卡，每个网卡可以分配一个或多个 IP 地址。IP 地址用于唯一标识网络中的设备，以便进行通信和数据传输。

## 二、   shutdown 

`shutdown` 是一个常用的命令，用于在 Linux 系统中安全地关闭系统或计划系统的重启。

### 1. 立即关机或重启

```bash
$ sudo shutdown [选项] [时间] [警告信息]
```

上述命令将根据选项来立即关机或重启系统。

### 2. 常用选项：

- `-h`：立即关机。
- `-r`：立即重启。
- `-c`：取消预定的关机或重启操作。
- `-t 时间`：设置关机或重启的延迟时间，单位为分钟。
- `-k`：发送警告消息而不实际执行关机或重启操作。

### 3. 示例：

```bash
$ sudo shutdown -h now
```

上述示例将立即关机系统。

```bash
$ sudo shutdown -r now
```

上述示例将立即重启系统。

```bash
$ sudo shutdown -h +10 "系统将在10分钟后关机"
```

上述示例将预定系统在10分钟后关机，并显示警告消息。

通过使用 `shutdown` 命令，可以安全地关闭或重启 Linux 系统。请确保以足够的权限执行命令，并提供正确的选项和参数。在执行关机或重启操作之前，请确保保存所有未保存的工作，并通知其他用户系统将被关闭或重启。

## 三、 ifconfig 

`ifconfig` 是一个常用的命令，用于显示和配置网络接口的信息，包括 IP 地址、MAC 地址、网络状态等。然而，在最新版本的 Linux 中，推荐使用 `ip` 命令来替代 `ifconfig`。

### 1. 显示网络接口信息

```bash
$ ifconfig
```

上述命令将显示系统中所有网络接口的信息，包括接口名称、IP 地址、MAC 地址、网络状态等。

### 2. 示例

```bash
$ ifconfig
```

上述示例将显示系统中所有网络接口的信息。

使用 `ifconfig` 命令时，请确保以足够的权限执行命令。请注意，尽管 `ifconfig` 在过去是网络接口配置的主要工具之一，但在最新版本的 Linux 中，它已经被 `ip` 命令替代。因此，为了更好地适应现代系统，请尽可能使用 `ip` 命令来显示和配置网络接口的信息。

## 四、 ping 

`ping` 是一个常用的命令，用于测试网络连接和检测目标主机的可达性。

### 1. 发送 ICMP 回应请求

```bash
$ ping [选项] 目标主机或 IP 地址
```

上述命令将向指定的目标主机或 IP 地址发送 ICMP 回应请求，并等待回应。

### 2. 常用选项

- `-c 数量`：指定发送回应请求的次数。
- `-i 秒数`：指定发送回应请求的时间间隔（秒数）。
- `-s 字节数`：指定发送回应请求的数据包大小（字节数）。
- `-t 超时时间`：指定等待回应的超时时间（毫秒）。
- `-W 超时时间`：指定等待回应的超时时间（秒数）。

### 3. 示例

```bash
$ ping example.com
```

上述示例将向 `example.com` 发送 ICMP 回应请求，并等待回应。

```bash
$ ping -c 5 -i 1 example.com
```

上述示例将向 `example.com` 发送 5 次 ICMP 回应请求，每隔 1 秒发送一次。

`ping` 命令对于测试网络连接、检测主机可达性和诊断网络问题非常有用。它可以帮助你确定目标主机是否可访问以及网络延迟的情况。请注意，在使用 `ping` 命令时，确保目标主机允许 ICMP 回应请求，并且可以通过防火墙或其他网络配置进行访问。

## 五、域名 和 端口号

域名是用于标识和定位网络上的资源的人类可读的名称。它提供了一种便于记忆和使用的方式来访问网站、电子邮件服务器、文件服务器等。域名通常由多个部分组成，以点号分隔，例如 `example.com`。

域名解析将域名转换为对应的 IP 地址，以便计算机能够在网络上定位和访问相应的资源。

端口号是用于标识网络通信中的特定应用程序或服务的数字标识。它是一个 16 位的数字，取值范围是从 0 到 65535。端口号将数据包传送到正确的应用程序，使得多个应用程序可以在同一台计算机上同时进行网络通信。

一些常见的端口号分配如下：

- 80：HTTP 通信的默认端口。
- 443：HTTPS 安全通信的默认端口。
- 25：SMTP 用于发送电子邮件的端口。
- 22：SSH 安全登录协议的端口。
- 21：FTP 文件传输协议的端口。
- 53：DNS 域名系统的端口。
- 3306：MySQL 数据库的端口。

在进行网络通信时，通过将域名和端口号组合起来，可以唯一标识和定位网络上的特定资源。例如，`example.com:80` 表示通过 HTTP 访问 `example.com` 的默认端口。

## 六、SSH

在实际开发中，Linux服务器都是被放在服务器机房里的，我们不能直接进入到服务器机房去操作这台Linux服务器，而是通过一些远程链接工具，对Linux服务器进行管理。

SSH 为 Secure Shell的缩写，由 IETF 的网络小组（Network Working Group）所制定；SSH 为建立在应用层基础上的安全协议。SSH 是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议。

Ubuntu默认没有安装ssh服务，需要我们使用代码手动的在Ubuntu服务器上安装ssh服务。

ssh是专门为远程登录提供的一个安全性协议，常用于远程登录，想要使用ssh服务，需要安装相应的服务端和客户端软件，当软件安装成功以后就可以使用ssh命令了，以后可以通过远程登录之间操作远程的服务器。

在 Linux 中 SSH 是非常常用的工具，通过SSH 客户端我们可以连接到运行了SSH 服务器的远程机器上

- SSH 客户端是一种使用 `Secure Shell（SSH）` 协议连接到远程计算机的软件程序
- SSH 是目前较可靠，专为远程登录会话和其他网络服务提供安全性的协议
  - 利用 `SSH 协议` 可以有效防止远程管理过程中的信息泄露
  - 通过 `SSH 协议` 可以对所有传输的数据进行加密，也能够防止 DNS 欺骗和 IP 欺骗
- SSH 的另一项优点是传输的数据可以是经过压缩的，所以可以加快传输的速度

### 1. 软件安装步骤

1. 假如Ubuntu作为服务端,需要安装ssh服务端软件. 执行命令: **sudo apt-get install openssh-server**
2. 客户端电脑如果是 **macOS** 系统则不需要安装 ssh 客户端软件，默认已经安装过了，**直接可以使用 ssh 命令**
3. 客户端电脑如果是Windows系统则需要安装**OpenSSH for Windows**这个软件

**Windows 下 SSH 客户端的安装**

- `Putty` http://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html
- `XShell` http://xshellcn.com

> 建议从官方网站下载正式的安装程序

**mac或Linux连接远程Linux服务器的方法**

终端输入：ssh 服务器名称@ip地址，回车后输入密码。

如果发现上面的命令无法使用，可能是没有开启或安装ssh服务，可以用下面命令在Linux服务器中先安装ssh服务： 

      切换root用户进行操作，切换命令：sudo -i
    
      1）sudo apt-get update    更新资源
    
      2）sudo apt-get install openssh-server   安装ssh服务
    
      3）ps -e | grep ssh  查看是否已启动
    
      4）/etc/init.d/ssh start  手动启动方式

另外，ssh的配置文件在/etc/ssh 中，名称为sshd_config。

### 2.  ssh命令格式

```
ssh [-p port] user@remote
ssh 用户名@ip地址
```

- `user` 是在远程机器上的用户名，如果不指定的话默认为当前用户

- `remote` 是远程机器的地址，可以是 **IP**／**域名**，或者是 **后面会提到的别名**

- `port` 是 **SSH Server 监听的端口**，如果不指定，就为默认值 `22`

  > 提示：
  >
  > - 使用 `exit` 退出当前用户的登录
  >
  > 注意：
  >
  > - `ssh` 这个终端命令只能在 `Linux` 或者 `UNIX` 系统下使用
  > - 如果在 `Windows` 系统中，可以安装 `PuTTY` 或者 `XShell` 客户端软件即可
  >
  > 提示：
  >
  > - 在工作中，SSH 服务器的端口号很有可能不是 22，如果遇到这种情况就需要使用 `-p` 选项，指定正确的端口号，否则无法正常连接到服务器

**说明:**

- 在一台电脑上可以安装安装ssh客户端和ssh服务端软件
- 在Ubuntu安装ssh客户端命令: sudo apt-get install openssh-client

### 3. 免密码登录

非对称加密算法

- 使用 **公钥** 加密的数据，需要使用 **私钥** 解密
- 使用 **私钥** 加密的数据，需要使用 **公钥** 解密

**步骤**

- 生成SSH私钥和公钥
  - 执行 `ssh-keygen -t rsa ` 即可生成 SSH 钥匙
  
  这样会在当前目录生成名为id_rsa的私钥文件和名为id_rsa.pub的公钥文件，-t表示密钥类型是rsa。
  如果你只输入ssh-keygen生成的RSA密钥长度为2048，如果你对安全性要求比较高可以指定4096位的长度：
  
  ```text
  ssh-keygen -b 4096 -t rsa
  ```
  
  这里-b就是多少位，当然你对这些参数感兴趣可以使用--help参数看看具体的含义和解释。
  
  当你在生成SSHKEY的时候在命令行下会提示你Enter file in which to save the key，让你确认密钥文件保存的路径，
  一般回车即可（一般默认会在当前用户家目录下的.ssh目录下）。
  
  第二个提示是 Enter passphrase (empty for no passphrase) 让你输入一个密钥的密码，如果不输入则留空；回车生成公私钥完毕 :)
  此时你可以使用cat命令看下自己的公私钥。

- 上传公钥到服务器
  - 执行 `ssh-copy-id -p port user@remote`，可以让远程服务器记住我们的公钥

将本地的公钥文件上传到服务器上，然后在服务器需要免密登录的用户家目录下查看是否有 ~/.ssh/authorized_keys 这个文件，
如果没有手动创建一个:

```bash
touch ~/.ssh/authorized_keys
```

然后我们将公钥内容写入到authorized_keys文件中，因为这个文件可能已经有内容了，所以你可以使用如下方式

```bash
cat -n ~/.ssh/rsa.pub ~/.ssh/authorized_keys
```

这样就将公钥内容追加到authorized_keys中了，然后需要注意配置权限了，否则SSH不会工作的。

1. 将.ssh目录的权限为700
2. 将authorized_keys目录的权限为600

**ssh-copy-id 复制公钥**

将本地的所有公钥都传到服务器，使用方法：

```bash
ssh-copy-id username@remote-server
```

**运用**

我们完成了这些步骤是不是就可以免密登录了呢？是的，你现在登录服务器：

```bash
ssh user@host -p22
```

注意修改你自己的登录信息。

### 4. 配置别名

每次都输入 `ssh -p port user@remote`，时间久了会觉得很麻烦，特别是当 `user`, `remote` 和 `port` 都得输入，而且还不好记忆

而配置别名可以让我们进一步偷懒，譬如用：`ssh mac` 来替代上面这么一长串，那么就在 `~/.ssh/config` 里面追加以下内容：

```text
Host mac
    HostName ip地址
    User itheima
    Port 22
```

保存之后，即可用 `ssh mac` 实现远程登录了，`scp` 同样可以使用

## 七、远程拷贝

### 1. scp 命令说明

scp是基于ssh进行远程文件拷贝的命令，也就是说需要保证服务端和客户端电脑安装了相应的ssh软件，以后可以把我们写代码远程拷贝到服务器。

使用该命令的前提条件要求目标主机已经成功安装openssh-server

```bash
如没有安装使用 sudo apt-get install openssh-server 来安装
```

- scp 就是 `secure copy`，是一个在 Linux 下用来进行远程拷贝文件的命令
- 它的地址格式与 ssh 基本相同，需要注意的是，在指定端口时用的是大写的 `-P` 而不是小写的


```bash
# 把本地当前目录下的 01.py 文件 复制到 远程 家目录下的 Desktop/01.py
# 注意：`:` 后面的路径如果不是绝对路径，则以用户的家目录作为参照路径
scp -P port 01.py user@remote:Desktop/01.py

# 把远程 家目录下的 Desktop/01.py 文件 复制到 本地当前目录下的 01.py
scp -P port user@remote:Desktop/01.py 01.py

# 加上 -r 选项可以传送文件夹
# 把当前目录下的 demo 文件夹 复制到 远程 家目录下的 Desktop
scp -r demo user@remote:Desktop

# 把远程 家目录下的 Desktop 复制到 当前目录下的 demo 文件夹
scp -r user@remote:Desktop demo
```

| 选项 |                             含义                             |
| :--: | :----------------------------------------------------------: |
|  -r  | 若给出的源文件是目录文件，则 scp 将递归复制该目录下的所有子目录和文件，目标文件必须为一个目录名 |
|  -P  | 若远程 SSH 服务器的端口不是 22，需要使用大写字母 -P 选项指定端口 |

> 注意：
>
> - `scp` 这个终端命令只能在 `Linux` 或者 `UNIX` 系统下使用
> - 如果在 `Windows` 系统中，可以安装 `PuTTY`，使用 `pscp` 命令行工具或者安装 `FileZilla` 使用 `FTP` 进行文件传输

### 2. FileZilla

- 官方网站：https://www.filezilla.cn/download/client
- `FileZilla` 在传输文件时，使用的是 `FTP 服务` 而不是 `SSH 服务`，因此端口号应该设置为 `21`

FileZilla 是一个免费开源的FTP软件, 使用可视化方式进行上传和下载文件。以后可以通过 FileZilla 来代替 **scp** 命令

